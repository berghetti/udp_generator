
server_ip: !import hosts.yml::server_ip
hosts: !import hosts.yml::hosts
programs: !import programs.yml::programs

commands:
    - program: prepare_afp
      hosts: server
      begin: 0
      enabled: $(hasarg('afp') or hasarg('all'))$

    - program: prepare_psp
      hosts: server
      begin: 0
      enabled: $(hasarg('psp') or hasarg('all'))$

    - program: prepare_clients
      hosts: [client0, client1, client2, client3, client4, client5]
      begin: 0
      enabled: $(hasarg('clients'))$

    - program: set_clients_ip
      hosts: [client0, client1, client2, client3, client4, client5]
      server_ip: '{0.server_ip}'
      start_after: prepare_clients
      enabled: $(hasarg('clients') or hasarg('all'))$

    - program: client_run_setup
      hosts: [client0, client1, client2, client3, client4, client5]
      begin: 0
      enabled: $(hasarg('setup_clients'))$


